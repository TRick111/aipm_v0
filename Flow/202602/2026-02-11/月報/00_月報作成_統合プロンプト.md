# 月報作成（メタ）統合プロンプト

> 本ファイルは **「月報プロジェクト全体の入口」** です。  
> 01〜03は **AIが参照してそのまま実行できる"手順書"** として整備し、更新履歴や設計意図は本ファイルに集約します。

**作成日**: 2026-02-11  
**更新日**: 2026-02-11

---

## 目的
- 月報作成の全フェーズ（基礎資料作成 → 週別深掘り分析 → スライド構成案作成 → 日報スライド作成）を **一気通貫で実行**する
- 成果物（特にスライド構成案）を、再現性ある手順で生成できる状態にする

---

## 必要なインプット（このメタプロンプトに渡す）

以下の情報を指定してください：

| 項目 | 説明 | 例 |
|------|------|-----|
| **運営会社** | 運営会社コード | `BBC` または `BFA` |
| **対象月** | 対象年月 | `2026-01` |
| **対象月の開始日** | 対象月の初日 | `2026-01-01` |
| **対象月の終了日** | 対象月の最終日 | `2026-01-31` |

### 運営会社コード一覧
- `BFA`: BAR FIVE Arrows
- `BBC`: 別天地　銀座（Dinii）
- `麻布しき`: 麻布しき（USENレジ）
- `キーポイント`: かめや駅前店（AirRegi）

---

## 実行テンプレート（AIに渡す）

以下をコピーして、変数部分を書き換えてAIに依頼してください：

```
月報を作成してください（メタプロンプト）。

## インプット情報
- 運営会社: {運営会社コード}
- 対象月: {対象月}
- 対象月の開始日: {開始日}
- 対象月の終了日: {終了日}

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_月報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_週別深堀分析_プロンプト.md` に従って週別深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成
4. `./04_日報スライド作成_プロンプト.md` に従って日報スライドを追加

## 最終成果物
- `./2_output/{運営会社コード}/2_output_{month_slug}/月報スライド構成案.md`
```

### コピペ用プロンプト

> 以下のブロックをそれぞれ別チャットに貼って実行してください。

---

#### ① BFA（BAR FIVE Arrows）

```
月報を作成してください。

## インプット情報
- 運営会社: BFA
- 対象月: 2026-01
- 対象月の開始日: 2026-01-01
- 対象月の終了日: 2026-01-31

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_月報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_週別深堀分析_プロンプト.md` に従って週別深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成
4. `./04_日報スライド作成_プロンプト.md` に従って日報スライドを追加

## 最終成果物
- `./2_output/BFA/2_output_202601/月報スライド構成案.md`
```

---

#### ② BBC（別天地　銀座）

```
月報を作成してください。

## インプット情報
- 運営会社: BBC
- 対象月: 2026-01
- 対象月の開始日: 2026-01-01
- 対象月の終了日: 2026-01-31

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_月報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_週別深堀分析_プロンプト.md` に従って週別深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成
4. `./04_日報スライド作成_プロンプト.md` に従って日報スライドを追加

## 最終成果物
- `./2_output/BBC/2_output_202601/月報スライド構成案.md`
```

---

#### ③ 麻布しき

```
月報を作成してください。

## インプット情報
- 運営会社: 麻布しき
- 対象月: 2026-01
- 対象月の開始日: 2026-01-01
- 対象月の終了日: 2026-01-31

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_月報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_週別深堀分析_プロンプト.md` に従って週別深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成
4. `./04_日報スライド作成_プロンプト.md` に従って日報スライドを追加

## 最終成果物
- `./2_output/麻布しき/2_output_202601/月報スライド構成案.md`
```

---

#### ④ キーポイント（かめや駅前店）

```
月報を作成してください。

## インプット情報
- 運営会社: キーポイント
- 対象月: 2026-01
- 対象月の開始日: 2026-01-01
- 対象月の終了日: 2026-01-31

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_月報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_週別深堀分析_プロンプト.md` に従って週別深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成
4. `./04_日報スライド作成_プロンプト.md` に従って日報スライドを追加

## 最終成果物
- `./2_output/キーポイント/2_output_202601/月報スライド構成案.md`
```

---

---

## 重要ルール（運用ガバナンス）
- 01/02/03/04は **AI実行手順のみ**（入力・手順・出力・チェック）を残す  
  - 更新履歴・背景説明・人向けの長文説明は **本ファイル（00）** に寄せる
- 変数名は 01/02/03/04で共通化する（下記の"変数"参照）
- 出力先は `2_output/{運営会社}/2_output_{month_slug}/` を標準とする  
  - `month_slug` は `2026-01` → `202601`（ハイフン除去）

## 変数（01/02/03/04で共通利用）
- `{運営会社コード}`: `BFA` / `BBC` / `麻布しき` / `キーポイント`
- `{対象月}`: `YYYY-MM`
- `{開始日}`: `YYYY-MM-DD`（対象月の初日）
- `{終了日}`: `YYYY-MM-DD`（対象月の最終日）
- `{month_slug}`: `YYYYMM`（例: `202601`）
- `{出力ディレクトリ}`: `./2_output/{運営会社コード}/2_output_{month_slug}`
- `{入力売上}`: `./1_input/{運営会社コード}/rawdata.csv`
- `{入力口コミ}`: `./1_input/{運営会社コード}/reviews.csv`
- `{入力日報}`: `./1_input/{運営会社コード}/DailyReport.csv`
- `{月報基礎資料}`: `{出力ディレクトリ}/月報作成基礎資料.md`
- `{スライド構成}`: `{出力ディレクトリ}/月報スライド構成案.md`

### AIが自動算出するもの（ユーザー入力不要）
- `{month_slug}`（例: `2026-01` → `202601`）
- `{出力ディレクトリ}`（上記ルールで組み立て）
- `{入力売上}` / `{入力口コミ}` / `{入力日報}`（上記ルールで組み立て）
- `{対象月に含まれるISO週}`: 対象月の営業日が1日でも含まれるISO週の一覧（例: `2026-W01` 〜 `2026-W05`）

---

## AIエージェントの実行フロー（概要）

```
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 0】準備                                                      │
│ - インプット情報を確認                                              │
│ - 入力データ（rawdata.csv, reviews.csv）の存在確認                  │
│ - {出力ディレクトリ} の作成                                         │
│ - 対象月に含まれるISO週の算出                                       │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 1】フェーズ1: 基礎資料作成                                   │
│ プロンプト: 01_月報作成プロンプトテンプレート.md                    │
│                                                                     │
│ 実行内容:                                                           │
│ 1. rawdata.csv から対象月のデータを集計・分析                       │
│ 2. 月次KPI（売上、客数、客単価、組数）を算出                       │
│ 3. 週別推移・曜日別集計・時間帯別集計を算出                        │
│ 4. カテゴリ別・商品別の月次集計を算出                               │
│ 5. 月報作成基礎資料.md を作成                                       │
│                                                                     │
│ 出力確認:                                                           │
│ - 月次集計データが生成されていること                                │
│ - 週別推移データが生成されていること                                │
│ - 月報作成基礎資料.md が作成されていること                          │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 2】フェーズ2: 週別深掘り分析                                 │
│ プロンプト: 02_週別深堀分析_プロンプト.md                           │
│                                                                     │
│ 実行内容:                                                           │
│ 1. 月内の各週の売上を比較し、好調週/不調週を特定                   │
│ 2. 好調週/不調週を5つの観点で比較分析                               │
│ 3. 月報作成基礎資料.md に深掘り分析を追記                           │
│                                                                     │
│ 出力確認:                                                           │
│ - 好調週と不調週が特定されていること                                │
│ - 曜日構成、時間帯、会計レベル、商品ミックスの分析結果              │
│ - 月報作成基礎資料.md に追記されていること                          │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 3】フェーズ3: スライド構成案作成                             │
│ プロンプト: 03_スライド構成案作成_プロンプト.md                     │
│                                                                     │
│ 実行内容:                                                           │
│ 1. スライドテンプレートを参照                                       │
│ 2. 月報作成基礎資料.md をもとにスライド構成案を作成                 │
│ 3. 各スライドにグラフ描画用のデータ表を記載                         │
│                                                                     │
│ 出力確認:                                                           │
│ - 30枚前後のスライド構成案が作成されていること                      │
│ - 各スライドにグラフ用データ表が含まれていること                    │
│ - 月報スライド構成案.md が保存されていること                        │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 4】フェーズ4: 日報スライド作成                               │
│ プロンプト: 04_日報スライド作成_プロンプト.md                       │
│                                                                     │
│ 実行内容:                                                           │
│ 1. DailyReport.csv から対象月のスタッフ日報を読み込み               │
│ 2. テーマを抽出し、4〜6枚のスライドを構成                          │
│ 3. 施策一覧の前に挿入し、スライド番号をリナンバー                   │
│                                                                     │
│ 出力確認:                                                           │
│ - 4〜6枚の日報スライドが追加されていること                          │
│ - 各スライドのタイトルが最大2つであること                            │
│ - 引用のみで構成され、分析コメントがないこと                        │
│ - 施策一覧の前に配置されていること                                  │
│ - 月報スライド構成案.md が更新保存されていること                    │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 5】完了報告                                                  │
│ - 作成されたファイル一覧を報告                                      │
│ - 主要なインサイト（月次売上、好調/不調週など）をサマリー報告       │
└─────────────────────────────────────────────────────────────────────┘
```

---

---

## 参照ファイル一覧

### プロンプトファイル
| 順番 | ファイル | 用途 |
|:---:|----------|------|
| 01 | `01_月報作成プロンプトテンプレート.md` | 基礎資料作成 |
| 02 | `02_週別深堀分析_プロンプト.md` | 週別深掘り分析 |
| 03 | `03_スライド構成案作成_プロンプト.md` | スライド構成案作成 |
| 04 | `04_日報スライド作成_プロンプト.md` | 日報スライド追加 |

### スクリプト
| ファイル | 用途 |
|----------|------|
| `./Scripts/analysis_script.py` | データ分析・グラフ生成（週報用を月報でも活用可能） |

> **注**: 月報用の専用分析スクリプトは今後必要に応じて整備する。  
> 初期段階では、rawdata.csv を直接読み込んで月次集計を行うか、  
> 既存の週報用 analysis_script.py を各週分実行してデータを統合する。

### 入力データ
| ファイル | 用途 |
|----------|------|
| `./1_input/{運営会社コード}/rawdata.csv` | 売上トランザクションデータ |
| `./1_input/{運営会社コード}/reviews.csv` | 口コミデータ |
| `./1_input/{運営会社コード}/DailyReport.csv` | スタッフ日報（フェーズ4で使用） |

---

---

## 最終成果物（完了条件）

以下のファイルが作成されていれば完了です：

```
Stock/RestaurantAILab/月報/2_output/{運営会社}/2_output_{month_slug}/
│
├── 【月報基礎資料】
│   └── 月報作成基礎資料.md
│
└── 【フェーズ3の成果物】
    └── 月報スライド構成案.md    ← 最終成果物
```

---

---

## エラー時の対応（最小）

### フェーズ1でエラーが発生した場合
- rawdata.csv または reviews.csv が存在するか確認
- 対象月のデータが含まれているか確認

### フェーズ2でエラーが発生した場合
- 月次集計データが生成されているか確認
- 好調/不調週の特定に必要なデータが揃っているか確認

### フェーズ3でエラーが発生した場合
- 月報作成基礎資料.md が作成されているか確認

### フェーズ4でエラーが発生した場合
- DailyReport.csv が `./1_input/{運営会社コード}/` に存在するか確認
- 対象月の営業日に該当するレコードがあるか確認
- DailyReport.csv が存在しない場合はフェーズ4をスキップし、そのまま完了とする

---

---

## 注意事項（設計意図）

1. **データの事前準備**
   - rawdata.csv と reviews.csv が対象月の全データを含んでいることを確認
   - 月初・月末の営業日データが欠落していないことを確認

2. **月の境界の扱い**
   - 月初/月末がISO週の途中にまたがる場合、**営業日（business_date）ベース**で月に帰属させる
   - 例: 2026-01-31（土）の深夜2時の売上 → 2026-01-31の営業日 → 1月に帰属

3. **営業日基準**
   - 深夜0-5時は前日の営業日としてカウント（週報と同じルール）
   - 時間別分析は18-26時（深夜は24時以降表記）

4. **週報との関係**
   - 月報は週報の上位集計であり、週報で使用したデータを月単位で再集計する
   - 週報の分析観点を月次に拡張し、より俯瞰的なトレンド分析を行う

5. **前月比・前年同月比**
   - 月報では「前月比」「前年同月比」を主要な比較軸とする
   - 週報の「前週比」「前年同週比」に相当する

---

## プロンプト資産の更新履歴（00に集約）

- 2026-02-11: 初版作成（週報プロンプト 00〜04 をベースに月次版へ変換）
