<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å£²ä¸Šç›®æ¨™æœªé”ã®æ ¹æœ¬åŸå› åˆ†æ - ãƒ•ã‚£ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ³å›³</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Yu Gothic', 'Hiragino Sans', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 1400px;
            width: 100%;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        #fishbone {
            width: 100%;
            height: 1600px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            background: #fafafa;
            overflow-x: auto;
        }

        .category-info {
            margin-top: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .category-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .category-card h3 {
            color: #333;
            margin-bottom: 12px;
            font-size: 1.3rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        .category-card ul {
            list-style: none;
        }

        .category-card li {
            padding: 8px 0;
            color: #555;
            font-size: 0.95rem;
            position: relative;
            padding-left: 20px;
        }

        .category-card li::before {
            content: "â–¸";
            position: absolute;
            left: 0;
            color: #667eea;
            font-weight: bold;
        }

        .category-card small {
            display: block;
            margin-top: 5px;
            line-height: 1.6;
            color: #666;
        }

        .category-card li {
            margin-bottom: 15px;
        }

        .legend {
            margin-top: 20px;
            padding: 15px;
            background: #f0f0f0;
            border-radius: 8px;
            text-align: center;
        }

        .legend-item {
            display: inline-block;
            margin: 0 15px;
            font-size: 0.9rem;
        }

        .legend-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 4px;
            margin-right: 5px;
            vertical-align: middle;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .container {
                padding: 20px;
            }
            
            #fishbone {
                height: 1200px;
            }

            .category-info {
                grid-template-columns: 1fr;
            }

            .category-card {
                margin-bottom: 15px;
            }
        }

        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸŸ å£²ä¸Šç›®æ¨™æœªé”ã®æ ¹æœ¬åŸå› åˆ†æ</h1>
        <p>ãƒ•ã‚£ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ³å›³ï¼ˆç‰¹æ€§è¦å› å›³ï¼‰ã«ã‚ˆã‚‹éšå±¤çš„èª²é¡Œã®å¯è¦–åŒ–</p>
    </div>

    <div class="container">
        <div class="controls">
            <button class="btn btn-primary" onclick="resetZoom()">ğŸ” ã‚ºãƒ¼ãƒ ãƒªã‚»ãƒƒãƒˆ</button>
            <button class="btn btn-primary" onclick="toggleAnimation()">âœ¨ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</button>
            <button class="btn btn-primary" onclick="exportSVG()">ğŸ’¾ SVGãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
        </div>

        <svg id="fishbone"></svg>

        <div class="legend">
            <div class="legend-item">
                <span class="legend-color" style="background: #ff6b6b;"></span>
                ãƒã‚¸ã‚·ãƒ§ãƒ‹ãƒ³ã‚°æ›–æ˜§ã•
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: #4ecdc4;"></span>
                ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³çµŒå–¶ä¸è¶³
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: #45b7d1;"></span>
                ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹ç‡æ€§
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: #96ceb4;"></span>
                å“è³ªã¨ãƒ–ãƒ©ãƒ³ãƒ‰ä¾¡å€¤ä¹–é›¢
            </div>
            <div class="legend-item">
                <span class="legend-color" style="background: #ffeaa7;"></span>
                é›†å®¢æ§‹é€ è„†å¼±æ€§
            </div>
        </div>

        <div class="category-info">
            <div class="category-card">
                <h3>ğŸ¯ ãƒã‚¸ã‚·ãƒ§ãƒ‹ãƒ³ã‚°æ›–æ˜§ã•</h3>
                <ul>
                    <li><strong>ç›®æŒ‡ã™æ–¹å‘ï¼šå‰µä½œå±…é…’å±‹</strong><br>
                        <small>ãƒ¢ãƒ€ãƒ³ã§æ´—ç·´ã•ã‚ŒãŸå‰µä½œå±…é…’å±‹ã‚’ç›®æŒ‡ã—ã¦ã„ã‚‹ãŒã€å®Ÿéš›ã®é‹å–¶ã¯å¾“æ¥å‹ã®å¤§è¡†å±…é…’å±‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç¶™ç¶š</small>
                    </li>
                    <li><strong>ç¾å®Ÿï¼šå¤§è¡†å±…é…’å±‹é‹å–¶</strong><br>
                        <small>ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹æˆã€ä¾¡æ ¼è¨­å®šã€ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«ãŒå¤§è¡†å±…é…’å±‹ãƒ¬ãƒ™ãƒ«ã«ç•™ã¾ã‚Šã€å‰µä½œå±…é…’å±‹ã¨ã—ã¦ã®å·®åˆ¥åŒ–ãŒã§ãã¦ã„ãªã„</small>
                    </li>
                    <li><strong>ãƒ–ãƒ©ãƒ³ãƒ‰IDä¸ä¸€è‡´</strong><br>
                        <small>ç›®æŒ‡ã™ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨å®Ÿéš›ã®æä¾›ä¾¡å€¤ã«ã‚®ãƒ£ãƒƒãƒ—ãŒã‚ã‚Šã€é¡§å®¢ãŒåº—èˆ—ã®ç‰¹å¾´ã‚’ç†è§£ã§ããªã„çŠ¶æ³</small>
                    </li>
                    <li><strong>å·®åˆ¥åŒ–å›°é›£</strong><br>
                        <small>ç«¶åˆã¨ã®æ˜ç¢ºãªé•ã„ã‚’æ‰“ã¡å‡ºã›ãšã€ä¾¡æ ¼ç«¶äº‰ã«å·»ãè¾¼ã¾ã‚Œã‚‹æ‚ªå¾ªç’°ã«</small>
                    </li>
                </ul>
            </div>
            <div class="category-card">
                <h3>ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³çµŒå–¶ä¸è¶³</h3>
                <ul>
                    <li><strong>ç„¡é§„ã‚³ã‚¹ãƒˆæŠŠæ¡ä¸èƒ½</strong><br>
                        <small>ABCåˆ†ææœªå®Ÿæ–½ã«ã‚ˆã‚Šã€å£²ã‚Œãªã„å•†å“ã‚„ç„¡é§„ãªåœ¨åº«ã«ã‹ã‹ã‚‹ã‚³ã‚¹ãƒˆã‚’å®šé‡çš„ã«æŠŠæ¡ã§ãã¦ã„ãªã„</small>
                    </li>
                    <li><strong>ãƒªãƒ”ãƒ¼ãƒˆç‡ä¸æ˜</strong><br>
                        <small>é¡§å®¢ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãŒæ´»ç”¨ã•ã‚Œã¦ãŠã‚‰ãšã€ã©ã®ãã‚‰ã„ã®é¡§å®¢ãŒãƒªãƒ”ãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‹ä¸æ˜</small>
                    </li>
                    <li><strong>é¡§å®¢è¡Œå‹•ãƒ‡ãƒ¼ã‚¿ä¸è¶³</strong><br>
                        <small>æ¥åº—é »åº¦ã€æ³¨æ–‡å‚¾å‘ã€å®¢å˜ä¾¡æ¨ç§»ãªã©ã®é‡è¦ãƒ‡ãƒ¼ã‚¿ãŒè“„ç©ã•ã‚Œã¦ã„ãªã„</small>
                    </li>
                    <li><strong>æ„æ€æ±ºå®šãŒå‹˜ä¾å­˜</strong><br>
                        <small>ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã‹ãªã„çµŒé¨“ã‚„å‹˜ã«ã‚ˆã‚‹æ„æ€æ±ºå®šã§ã€æ–½ç­–åŠ¹æœã®æ¸¬å®šã‚‚å›°é›£</small>
                    </li>
                </ul>
            </div>
            <div class="category-card">
                <h3>âš™ï¸ ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹ç‡æ€§</h3>
                <ul>
                    <li><strong>ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ•°éå¤š</strong><br>
                        <small>ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ•°ãŒå¤šã™ãã‚‹ã“ã¨ã§ã€ä»•è¾¼ã¿æ™‚é–“å¢—åŠ ã€åœ¨åº«ç®¡ç†è¤‡é›‘åŒ–ã€é£Ÿæå»ƒæ£„å¢—åŠ ãªã©ã‚³ã‚¹ãƒˆãŒè†¨ã‚‰ã‚€</small>
                    </li>
                    <li><strong>åœ¨åº«ç®¡ç†ä¸é©åˆ‡</strong><br>
                        <small>é£Ÿæã®ç™ºæ³¨ãƒ»åœ¨åº«ç®¡ç†ãŒé©åˆ‡ã§ãªãã€éå‰°åœ¨åº«ã‚„å“åˆ‡ã‚ŒãŒé »ç™ºã—ã€å»ƒæ£„ãƒ­ã‚¹ãŒå¢—åŠ </small>
                    </li>
                    <li><strong>å£²ä¸ŠåŸä¾¡ç‡æ‚ªåŒ–</strong><br>
                        <small>é©åˆ‡ãªåŸä¾¡ç®¡ç†ãŒã§ãã¦ãŠã‚‰ãšã€åˆ©ç›Šã‚’åœ§è¿«ã€‚ç›®æ¨™åŸä¾¡ç‡ã‚’å¤§ããè¶…ãˆã‚‹å•†å“ãŒå­˜åœ¨</small>
                    </li>
                    <li><strong>ç››ã‚Šä»˜ã‘çŸ¥è­˜ä¸è¶³</strong><br>
                        <small>å‰µä½œå±…é…’å±‹ã¨ã—ã¦ã®ç››ã‚Šä»˜ã‘ã‚„ãŠçš¿é¸ã³ã®çŸ¥è­˜ãŒä¸è¶³ã—ã€è¦‹ãŸç›®ã®ä¾¡å€¤å‘ä¸ŠãŒã§ãã¦ã„ãªã„</small>
                    </li>
                </ul>
            </div>
            <div class="category-card">
                <h3>âœ¨ å“è³ªã¨ãƒ–ãƒ©ãƒ³ãƒ‰ä¾¡å€¤ä¹–é›¢</h3>
                <ul>
                    <li><strong>Webå†™çœŸã¨å®Ÿç‰©ã‚®ãƒ£ãƒƒãƒ—</strong><br>
                        <small>ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚„SNSã®æ–™ç†å†™çœŸã¨å®Ÿéš›ã®æä¾›æ–™ç†ã«ã‚®ãƒ£ãƒƒãƒ—ãŒã‚ã‚Šã€é¡§å®¢ã®æœŸå¾…ã‚’è£åˆ‡ã‚‹çµæœã«</small>
                    </li>
                    <li><strong>æœŸå¾…å€¤ç®¡ç†å¤±æ•—</strong><br>
                        <small>é›†å®¢æ™‚ã«è¨­å®šã—ãŸæœŸå¾…å€¤ã¨å®Ÿéš›ã®ä½“é¨“ãŒä¸€è‡´ã›ãšã€é¡§å®¢æº€è¶³åº¦ãŒä½ä¸‹</small>
                    </li>
                    <li><strong>ã‚µãƒ¼ãƒ“ã‚¹å“è³ªä½ä¸‹</strong><br>
                        <small>ã‚¹ã‚¿ãƒƒãƒ•æ•™è‚²ä¸è¶³ã‚„ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ··ä¹±ã«ã‚ˆã‚Šã€æ¥å®¢ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã®å“è³ªãŒä¸å®‰å®š</small>
                    </li>
                    <li><strong>ãƒªãƒ”ãƒ¼ãƒˆç‡ä½ä¸‹</strong><br>
                        <small>æœŸå¾…ã‚’ä¸‹å›ã‚‹ä½“é¨“ã«ã‚ˆã‚Šã€ä¸€åº¦æ¥åº—ã—ã¦ã‚‚å†æ¥åº—ã«ã¤ãªãŒã‚‰ãªã„æ‚ªå¾ªç’°</small>
                    </li>
                </ul>
            </div>
            <div class="category-card">
                <h3>ğŸª é›†å®¢æ§‹é€ è„†å¼±æ€§</h3>
                <ul>
                    <li><strong>2éšç«‹åœ°â†’Webä¾å­˜</strong><br>
                        <small>2éšã¨ã„ã†ç«‹åœ°ã®ãŸã‚é€šè¡Œäººã®ç›®ã«ç•™ã¾ã‚Šã«ããã€ã‚¦ã‚§ãƒ–é›†å®¢ã«éåº¦ã«ä¾å­˜ã™ã‚‹æ§‹é€ </small>
                    </li>
                    <li><strong>å¹³æ—¥(æœˆ-æœ¨)é›†å®¢ä¸è¶³</strong><br>
                        <small>é€±æœ«ã¯é›†å®¢ã§ãã‚‹ãŒã€å¹³æ—¥ç‰¹ã«æœˆæ›œï½æœ¨æ›œã®é›†å®¢ãŒå¼±ãã€é€±å…¨ä½“ã®ç¨¼åƒç‡ãŒä½ã„</small>
                    </li>
                    <li><strong>ç¨¼åƒç‡ä½ä¸‹</strong><br>
                        <small>å¹³æ—¥ã®ç©ºå¸­ãŒå¤šãã€å›ºå®šè²»ã‚’å›åã§ããªã„æ—¥ãŒç¶šãã€å£²ä¸Šæ©Ÿä¼šã‚’å¤§ããæå¤±</small>
                    </li>
                    <li><strong>LINEæ–½ç­–ä¸ååˆ†</strong><br>
                        <small>å…¬å¼LINEã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­è¨ˆãŒä¸ååˆ†ã§ã€é¡§å®¢ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚„ãƒªãƒ”ãƒ¼ãƒˆä¿ƒé€²ã«æ´»ç”¨ã§ãã¦ã„ãªã„</small>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        const svg = document.getElementById('fishbone');
        const tooltip = document.getElementById('tooltip');
        let animationEnabled = true;

        // ãƒ‡ãƒ¼ã‚¿å®šç¾©ï¼ˆè©³ç´°èª¬æ˜ä»˜ãï¼‰
        const data = {
            problem: "å£²ä¸Šç›®æ¨™\næœªé”",
            categories: [
                {
                    name: "ãƒã‚¸ã‚·ãƒ§ãƒ‹ãƒ³ã‚°\næ›–æ˜§ã•",
                    color: "#ff6b6b",
                    position: "top",
                    factors: [
                        { 
                            title: "ç›®æŒ‡ã™æ–¹å‘ï¼šå‰µä½œå±…é…’å±‹",
                            detail: "ãƒ¢ãƒ€ãƒ³ã§æ´—ç·´ã•ã‚ŒãŸå‰µä½œå±…é…’å±‹ã‚’ç›®æŒ‡ã—ã¦ã„ã‚‹ãŒã€å®Ÿéš›ã®é‹å–¶ã¯å¾“æ¥å‹ã®å¤§è¡†å±…é…’å±‹ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç¶™ç¶š"
                        },
                        { 
                            title: "ç¾å®Ÿï¼šå¤§è¡†å±…é…’å±‹é‹å–¶",
                            detail: "ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ§‹æˆã€ä¾¡æ ¼è¨­å®šã€ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ã‚¿ã‚¤ãƒ«ãŒå¤§è¡†å±…é…’å±‹ãƒ¬ãƒ™ãƒ«ã«ç•™ã¾ã‚Šã€å‰µä½œå±…é…’å±‹ã¨ã—ã¦ã®å·®åˆ¥åŒ–ãŒã§ãã¦ã„ãªã„"
                        },
                        { 
                            title: "ãƒ–ãƒ©ãƒ³ãƒ‰IDä¸ä¸€è‡´",
                            detail: "ç›®æŒ‡ã™ãƒ–ãƒ©ãƒ³ãƒ‰ã‚¤ãƒ¡ãƒ¼ã‚¸ã¨å®Ÿéš›ã®æä¾›ä¾¡å€¤ã«ã‚®ãƒ£ãƒƒãƒ—ãŒã‚ã‚Šã€é¡§å®¢ãŒåº—èˆ—ã®ç‰¹å¾´ã‚’ç†è§£ã§ããªã„çŠ¶æ³"
                        },
                        { 
                            title: "å·®åˆ¥åŒ–å›°é›£",
                            detail: "ç«¶åˆã¨ã®æ˜ç¢ºãªé•ã„ã‚’æ‰“ã¡å‡ºã›ãšã€ä¾¡æ ¼ç«¶äº‰ã«å·»ãè¾¼ã¾ã‚Œã‚‹æ‚ªå¾ªç’°ã«"
                        }
                    ]
                },
                {
                    name: "ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³\nçµŒå–¶ä¸è¶³",
                    color: "#4ecdc4",
                    position: "top",
                    factors: [
                        { 
                            title: "ç„¡é§„ã‚³ã‚¹ãƒˆæŠŠæ¡ä¸èƒ½",
                            detail: "ABCåˆ†ææœªå®Ÿæ–½ã«ã‚ˆã‚Šã€å£²ã‚Œãªã„å•†å“ã‚„ç„¡é§„ãªåœ¨åº«ã«ã‹ã‹ã‚‹ã‚³ã‚¹ãƒˆã‚’å®šé‡çš„ã«æŠŠæ¡ã§ãã¦ã„ãªã„"
                        },
                        { 
                            title: "ãƒªãƒ”ãƒ¼ãƒˆç‡ä¸æ˜",
                            detail: "é¡§å®¢ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãŒæ´»ç”¨ã•ã‚Œã¦ãŠã‚‰ãšã€ã©ã®ãã‚‰ã„ã®é¡§å®¢ãŒãƒªãƒ”ãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‹ä¸æ˜"
                        },
                        { 
                            title: "é¡§å®¢è¡Œå‹•ãƒ‡ãƒ¼ã‚¿ä¸è¶³",
                            detail: "æ¥åº—é »åº¦ã€æ³¨æ–‡å‚¾å‘ã€å®¢å˜ä¾¡æ¨ç§»ãªã©ã®é‡è¦ãƒ‡ãƒ¼ã‚¿ãŒè“„ç©ã•ã‚Œã¦ã„ãªã„"
                        },
                        { 
                            title: "æ„æ€æ±ºå®šãŒå‹˜ä¾å­˜",
                            detail: "ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã‹ãªã„çµŒé¨“ã‚„å‹˜ã«ã‚ˆã‚‹æ„æ€æ±ºå®šã§ã€æ–½ç­–åŠ¹æœã®æ¸¬å®šã‚‚å›°é›£"
                        }
                    ]
                },
                {
                    name: "ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³\nåŠ¹ç‡æ€§",
                    color: "#45b7d1",
                    position: "bottom",
                    factors: [
                        { 
                            title: "ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ•°éå¤š",
                            detail: "ãƒ¡ãƒ‹ãƒ¥ãƒ¼æ•°ãŒå¤šã™ãã‚‹ã“ã¨ã§ã€ä»•è¾¼ã¿æ™‚é–“å¢—åŠ ã€åœ¨åº«ç®¡ç†è¤‡é›‘åŒ–ã€é£Ÿæå»ƒæ£„å¢—åŠ ãªã©ã‚³ã‚¹ãƒˆãŒè†¨ã‚‰ã‚€"
                        },
                        { 
                            title: "åœ¨åº«ç®¡ç†ä¸é©åˆ‡",
                            detail: "é£Ÿæã®ç™ºæ³¨ãƒ»åœ¨åº«ç®¡ç†ãŒé©åˆ‡ã§ãªãã€éå‰°åœ¨åº«ã‚„å“åˆ‡ã‚ŒãŒé »ç™ºã—ã€å»ƒæ£„ãƒ­ã‚¹ãŒå¢—åŠ "
                        },
                        { 
                            title: "å£²ä¸ŠåŸä¾¡ç‡æ‚ªåŒ–",
                            detail: "é©åˆ‡ãªåŸä¾¡ç®¡ç†ãŒã§ãã¦ãŠã‚‰ãšã€åˆ©ç›Šã‚’åœ§è¿«ã€‚ç›®æ¨™åŸä¾¡ç‡ã‚’å¤§ããè¶…ãˆã‚‹å•†å“ãŒå­˜åœ¨"
                        },
                        { 
                            title: "ç››ã‚Šä»˜ã‘çŸ¥è­˜ä¸è¶³",
                            detail: "å‰µä½œå±…é…’å±‹ã¨ã—ã¦ã®ç››ã‚Šä»˜ã‘ã‚„ãŠçš¿é¸ã³ã®çŸ¥è­˜ãŒä¸è¶³ã—ã€è¦‹ãŸç›®ã®ä¾¡å€¤å‘ä¸ŠãŒã§ãã¦ã„ãªã„"
                        }
                    ]
                },
                {
                    name: "å“è³ªã¨ãƒ–ãƒ©ãƒ³ãƒ‰\nä¾¡å€¤ä¹–é›¢",
                    color: "#96ceb4",
                    position: "bottom",
                    factors: [
                        { 
                            title: "Webå†™çœŸã¨å®Ÿç‰©ã‚®ãƒ£ãƒƒãƒ—",
                            detail: "ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆã‚„SNSã®æ–™ç†å†™çœŸã¨å®Ÿéš›ã®æä¾›æ–™ç†ã«ã‚®ãƒ£ãƒƒãƒ—ãŒã‚ã‚Šã€é¡§å®¢ã®æœŸå¾…ã‚’è£åˆ‡ã‚‹çµæœã«"
                        },
                        { 
                            title: "æœŸå¾…å€¤ç®¡ç†å¤±æ•—",
                            detail: "é›†å®¢æ™‚ã«è¨­å®šã—ãŸæœŸå¾…å€¤ã¨å®Ÿéš›ã®ä½“é¨“ãŒä¸€è‡´ã›ãšã€é¡§å®¢æº€è¶³åº¦ãŒä½ä¸‹"
                        },
                        { 
                            title: "ã‚µãƒ¼ãƒ“ã‚¹å“è³ªä½ä¸‹",
                            detail: "ã‚¹ã‚¿ãƒƒãƒ•æ•™è‚²ä¸è¶³ã‚„ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ··ä¹±ã«ã‚ˆã‚Šã€æ¥å®¢ã‚„ã‚µãƒ¼ãƒ“ã‚¹ã®å“è³ªãŒä¸å®‰å®š"
                        },
                        { 
                            title: "ãƒªãƒ”ãƒ¼ãƒˆç‡ä½ä¸‹",
                            detail: "æœŸå¾…ã‚’ä¸‹å›ã‚‹ä½“é¨“ã«ã‚ˆã‚Šã€ä¸€åº¦æ¥åº—ã—ã¦ã‚‚å†æ¥åº—ã«ã¤ãªãŒã‚‰ãªã„æ‚ªå¾ªç’°"
                        }
                    ]
                },
                {
                    name: "é›†å®¢æ§‹é€ \nè„†å¼±æ€§",
                    color: "#ffeaa7",
                    position: "top",
                    factors: [
                        { 
                            title: "2éšç«‹åœ°â†’Webä¾å­˜",
                            detail: "2éšã¨ã„ã†ç«‹åœ°ã®ãŸã‚é€šè¡Œäººã®ç›®ã«ç•™ã¾ã‚Šã«ããã€ã‚¦ã‚§ãƒ–é›†å®¢ã«éåº¦ã«ä¾å­˜ã™ã‚‹æ§‹é€ "
                        },
                        { 
                            title: "å¹³æ—¥(æœˆ-æœ¨)é›†å®¢ä¸è¶³",
                            detail: "é€±æœ«ã¯é›†å®¢ã§ãã‚‹ãŒã€å¹³æ—¥ç‰¹ã«æœˆæ›œï½æœ¨æ›œã®é›†å®¢ãŒå¼±ãã€é€±å…¨ä½“ã®ç¨¼åƒç‡ãŒä½ã„"
                        },
                        { 
                            title: "ç¨¼åƒç‡ä½ä¸‹",
                            detail: "å¹³æ—¥ã®ç©ºå¸­ãŒå¤šãã€å›ºå®šè²»ã‚’å›åã§ããªã„æ—¥ãŒç¶šãã€å£²ä¸Šæ©Ÿä¼šã‚’å¤§ããæå¤±"
                        },
                        { 
                            title: "LINEæ–½ç­–ä¸ååˆ†",
                            detail: "å…¬å¼LINEã®ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³è¨­è¨ˆãŒä¸ååˆ†ã§ã€é¡§å®¢ã‚¨ãƒ³ã‚²ãƒ¼ã‚¸ãƒ¡ãƒ³ãƒˆã‚„ãƒªãƒ”ãƒ¼ãƒˆä¿ƒé€²ã«æ´»ç”¨ã§ãã¦ã„ãªã„"
                        }
                    ]
                }
            ]
        };

        function drawFishbone() {
            const width = Math.max(svg.clientWidth, 1800);
            const height = Math.max(svg.clientHeight, 1600);
            
            svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
            svg.innerHTML = '';

            // èƒŒæ™¯ã®ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾©
            const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
            const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
            gradient.setAttribute('id', 'spineGradient');
            gradient.innerHTML = `
                <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
            `;
            defs.appendChild(gradient);
            svg.appendChild(defs);

            const centerY = height / 2;
            const startX = 50;
            const endX = width - 150;
            const headX = width - 50;

            // èƒŒéª¨ï¼ˆä¸­å¿ƒç·šï¼‰ã‚’æç”»
            drawLine(startX, centerY, endX, centerY, 'url(#spineGradient)', 4);

            // é­šã®é ­éƒ¨ï¼ˆå•é¡Œï¼‰ã‚’æç”»
            drawHead(endX, centerY, headX, centerY, data.problem);

            // ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«éª¨ã‚’æç”»
            const categoryWidth = (endX - startX) / data.categories.length;
            
            data.categories.forEach((category, index) => {
                const x = startX + categoryWidth * (index + 0.5);
                const isTop = category.position === "top";
                const angle = isTop ? -45 : 45;
                
                drawCategory(x, centerY, category, angle, index);
            });
        }

        function drawLine(x1, y1, x2, y2, color, width = 2, className = '') {
            const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
            line.setAttribute('x1', x1);
            line.setAttribute('y1', y1);
            line.setAttribute('x2', x2);
            line.setAttribute('y2', y2);
            line.setAttribute('stroke', color);
            line.setAttribute('stroke-width', width);
            line.setAttribute('class', className);
            
            if (animationEnabled) {
                line.style.strokeDasharray = Math.sqrt(Math.pow(x2-x1, 2) + Math.pow(y2-y1, 2));
                line.style.strokeDashoffset = line.style.strokeDasharray;
                line.style.animation = 'drawLine 1s ease-out forwards';
            }
            
            svg.appendChild(line);
            return line;
        }

        function drawHead(x1, y1, x2, y2, text) {
            // é­šã®é ­éƒ¨ã®ä¸‰è§’å½¢
            const headSize = 80;
            const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            const points = `${x2},${y2} ${x2-headSize},${y2-headSize/2} ${x2-headSize},${y2+headSize/2}`;
            polygon.setAttribute('points', points);
            polygon.setAttribute('fill', '#667eea');
            polygon.setAttribute('stroke', '#764ba2');
            polygon.setAttribute('stroke-width', '4');
            
            if (animationEnabled) {
                polygon.style.opacity = '0';
                polygon.style.animation = 'fadeIn 0.5s ease-out 0.5s forwards';
            }
            
            svg.appendChild(polygon);

            // å•é¡Œãƒ†ã‚­ã‚¹ãƒˆ
            const textLines = text.split('\n');
            const textGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            
            textLines.forEach((line, i) => {
                const textElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                textElement.setAttribute('x', x2 - headSize/2);
                textElement.setAttribute('y', y2 + (i - textLines.length/2 + 0.5) * 24);
                textElement.setAttribute('text-anchor', 'middle');
                textElement.setAttribute('dominant-baseline', 'middle');
                textElement.setAttribute('fill', 'white');
                textElement.setAttribute('font-size', '20');
                textElement.setAttribute('font-weight', 'bold');
                textElement.textContent = line;
                
                if (animationEnabled) {
                    textElement.style.opacity = '0';
                    textElement.style.animation = 'fadeIn 0.5s ease-out 0.7s forwards';
                }
                
                textGroup.appendChild(textElement);
            });
            
            svg.appendChild(textGroup);
        }

        function drawCategory(x, centerY, category, angle, index) {
            const boneLength = 200;
            const isTop = angle < 0;
            const angleRad = (angle * Math.PI) / 180;
            
            const endX = x + boneLength * Math.cos(angleRad);
            const endY = centerY + boneLength * Math.sin(angleRad);

            // å¤§éª¨
            const mainBone = drawLine(x, centerY, endX, endY, category.color, 4, 'main-bone');
            
            if (animationEnabled) {
                mainBone.style.animationDelay = `${index * 0.1}s`;
            }

            // ã‚«ãƒ†ã‚´ãƒªåï¼ˆè¤‡æ•°è¡Œå¯¾å¿œï¼‰
            const categoryLines = category.name.split('\n');
            categoryLines.forEach((line, lineIndex) => {
                const categoryText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                categoryText.setAttribute('x', endX);
                categoryText.setAttribute('y', endY + (isTop ? -35 - (categoryLines.length - lineIndex - 1) * 20 : 45 + lineIndex * 20));
                categoryText.setAttribute('text-anchor', 'middle');
                categoryText.setAttribute('fill', category.color);
                categoryText.setAttribute('font-size', '20');
                categoryText.setAttribute('font-weight', 'bold');
                categoryText.textContent = line;
                
                if (animationEnabled) {
                    categoryText.style.opacity = '0';
                    categoryText.style.animation = `fadeIn 0.5s ease-out ${index * 0.1 + 0.3}s forwards`;
                }
                
                svg.appendChild(categoryText);
            });

            // å°éª¨ï¼ˆè¦å› ï¼‰- é–“éš”ã‚’åºƒã’ã‚‹
            const verticalSpacing = isTop ? 180 : 180; // å„è¦å› é–“ã®ã‚¹ãƒšãƒ¼ã‚¹
            category.factors.forEach((factor, factorIndex) => {
                const factorSpacing = boneLength / (category.factors.length + 1);
                const factorX = x + factorSpacing * (factorIndex + 1) * Math.cos(angleRad);
                const factorY = centerY + factorSpacing * (factorIndex + 1) * Math.sin(angleRad);
                
                const smallBoneLength = 150;
                const smallBoneEndX = factorX + smallBoneLength * Math.cos(angleRad + (isTop ? Math.PI/4 : -Math.PI/4));
                const smallBoneEndY = factorY + smallBoneLength * Math.sin(angleRad + (isTop ? Math.PI/4 : -Math.PI/4));

                // å°éª¨ã®ç·š
                const smallBone = drawLine(factorX, factorY, smallBoneEndX, smallBoneEndY, category.color, 2.5, 'small-bone');
                
                if (animationEnabled) {
                    smallBone.style.animationDelay = `${index * 0.1 + factorIndex * 0.05}s`;
                }

                // è¦å› ã‚¿ã‚¤ãƒˆãƒ«ã¨è©³ç´°ã‚’è¤‡æ•°è¡Œã§è¡¨ç¤º
                const textGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                
                // ã‚¿ã‚¤ãƒˆãƒ«
                const titleText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                titleText.setAttribute('x', smallBoneEndX + 10);
                titleText.setAttribute('y', smallBoneEndY + (isTop ? -15 : 25));
                titleText.setAttribute('text-anchor', 'start');
                titleText.setAttribute('fill', category.color);
                titleText.setAttribute('font-size', '14');
                titleText.setAttribute('font-weight', 'bold');
                titleText.textContent = factor.title;
                
                if (animationEnabled) {
                    titleText.style.opacity = '0';
                    titleText.style.animation = `fadeIn 0.5s ease-out ${index * 0.1 + factorIndex * 0.05 + 0.2}s forwards`;
                }
                
                textGroup.appendChild(titleText);

                // è©³ç´°èª¬æ˜ï¼ˆæ”¹è¡Œå¯¾å¿œï¼‰
                const detailLines = wrapText(factor.detail, 40); // 40æ–‡å­—ã§æŠ˜ã‚Šè¿”ã—
                detailLines.forEach((line, lineIndex) => {
                    const detailText = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                    detailText.setAttribute('x', smallBoneEndX + 10);
                    detailText.setAttribute('y', smallBoneEndY + (isTop ? -15 : 25) + (lineIndex + 1) * 16);
                    detailText.setAttribute('text-anchor', 'start');
                    detailText.setAttribute('fill', '#555');
                    detailText.setAttribute('font-size', '11');
                    detailText.textContent = line;
                    
                    if (animationEnabled) {
                        detailText.style.opacity = '0';
                        detailText.style.animation = `fadeIn 0.5s ease-out ${index * 0.1 + factorIndex * 0.05 + 0.3}s forwards`;
                    }
                    
                    textGroup.appendChild(detailText);
                });

                // èƒŒæ™¯çŸ©å½¢ï¼ˆèª­ã¿ã‚„ã™ã•å‘ä¸Šï¼‰
                const textBBox = titleText.getBBox ? titleText.getBBox() : { x: smallBoneEndX + 10, y: smallBoneEndY - 20, width: 300, height: 60 };
                const bgRect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                bgRect.setAttribute('x', smallBoneEndX + 5);
                bgRect.setAttribute('y', smallBoneEndY + (isTop ? -25 : 15));
                bgRect.setAttribute('width', 350);
                bgRect.setAttribute('height', (detailLines.length + 1) * 16 + 10);
                bgRect.setAttribute('fill', 'white');
                bgRect.setAttribute('fill-opacity', '0.85');
                bgRect.setAttribute('rx', '6');
                bgRect.setAttribute('stroke', category.color);
                bgRect.setAttribute('stroke-width', '1');
                bgRect.setAttribute('stroke-opacity', '0.3');
                
                if (animationEnabled) {
                    bgRect.style.opacity = '0';
                    bgRect.style.animation = `fadeIn 0.5s ease-out ${index * 0.1 + factorIndex * 0.05 + 0.15}s forwards`;
                }

                svg.appendChild(bgRect);
                svg.appendChild(textGroup);
            });
        }

        // ãƒ†ã‚­ã‚¹ãƒˆæŠ˜ã‚Šè¿”ã—é–¢æ•°
        function wrapText(text, maxLength) {
            const words = text.split('');
            const lines = [];
            let currentLine = '';
            
            for (let i = 0; i < words.length; i++) {
                if (currentLine.length + 1 <= maxLength) {
                    currentLine += words[i];
                } else {
                    lines.push(currentLine);
                    currentLine = words[i];
                }
            }
            if (currentLine) {
                lines.push(currentLine);
            }
            
            return lines;
        }

        function showTooltip(event, title, detail, category) {
            tooltip.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px; color: #fff; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px;">
                    ${category}
                </div>
                <div style="font-weight: 600; margin-bottom: 5px; font-size: 13px;">
                    ${title}
                </div>
                <div style="font-size: 12px; line-height: 1.5; opacity: 0.95;">
                    ${detail}
                </div>
            `;
            tooltip.style.opacity = '1';
            tooltip.style.maxWidth = '350px';
            updateTooltipPosition(event);
        }

        function updateTooltipPosition(event) {
            tooltip.style.left = event.pageX + 10 + 'px';
            tooltip.style.top = event.pageY + 10 + 'px';
        }

        function hideTooltip() {
            tooltip.style.opacity = '0';
        }

        function resetZoom() {
            drawFishbone();
        }

        function toggleAnimation() {
            animationEnabled = !animationEnabled;
            drawFishbone();
        }

        function exportSVG() {
            const svgData = svg.outerHTML;
            const blob = new Blob([svgData], { type: 'image/svg+xml' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'fishbone_diagram.svg';
            link.click();
            URL.revokeObjectURL(url);
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç”¨CSS
        const style = document.createElement('style');
        style.textContent = `
            @keyframes drawLine {
                to {
                    stroke-dashoffset: 0;
                }
            }
            @keyframes fadeIn {
                to {
                    opacity: 1;
                }
            }
        `;
        document.head.appendChild(style);

        // åˆæœŸæç”»
        drawFishbone();

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºæ™‚ã®å†æç”»
        window.addEventListener('resize', drawFishbone);
    </script>
</body>
</html>
