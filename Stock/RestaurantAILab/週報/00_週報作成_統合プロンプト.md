# 週報作成（メタ）統合プロンプト

> 本ファイルは **「週報プロジェクト全体の入口」** です。  
> 01〜03は **AIが参照してそのまま実行できる“手順書”** として整備し、更新履歴や設計意図は本ファイルに集約します。

**作成日**: 2026-01-27  
**更新日**: 2026-01-28

---

## 目的
- 週報作成の全フェーズ（基礎資料作成 → 曜日深掘り分析 → スライド構成案作成）を **一気通貫で実行**する
- 成果物（特にスライド構成案）を、再現性ある手順で生成できる状態にする

---

## 必要なインプット（このメタプロンプトに渡す）

以下の情報を指定してください：

| 項目 | 説明 | 例 |
|------|------|-----|
| **運営会社** | 運営会社コード | `BBC` または `BFA` |
| **対象週** | ISO週番号 | `2026-W04` |
| **対象週の終了日** | 対象週の最終日（既定: 日曜） | `2026-01-25` |

### 運営会社コード一覧
- `BFA`: BAR FIVE Arrows
- `BBC`: 別天地　銀座（Dinii）
- `麻布しき`: 麻布しき（USENレジ）
- `キーポイント`: かめや駅前店（AirRegi）

---

## 実行テンプレート（AIに渡す）

以下をコピーして、変数部分を書き換えてAIに依頼してください：

```
週報を作成してください（メタプロンプト）。

## インプット情報
- 運営会社: {運営会社コード}
- 対象週: {対象週}
- 対象週の終了日: {終了日}

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_週報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_曜日深堀分析_プロンプト.md` に従って曜日深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成

## 最終成果物
- `./2_output/{運営会社コード}/2_output_{week_slug}/週報スライド構成案.md`
```

### 四店舗プロンプト（コピペ用）

> 以下の4ブロックをそれぞれ別チャットに貼って実行してください。

---

#### ① BFA（BAR FIVE Arrows）

```
週報を作成してください。

## インプット情報
- 運営会社: BFA
- 対象週: 2026-W06
- 対象週の終了日: 2026-02-08

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_週報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_曜日深堀分析_プロンプト.md` に従って曜日深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成

## 最終成果物
- `./2_output/BFA/2_output_2026w06/週報スライド構成案.md`
```

---

#### ② BBC（別天地　銀座）

```
週報を作成してください。

## インプット情報
- 運営会社: BBC
- 対象週: 2026-W06
- 対象週の終了日: 2026-02-08

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_週報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_曜日深堀分析_プロンプト.md` に従って曜日深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成

## 最終成果物
- `./2_output/BBC/2_output_2026w06/週報スライド構成案.md`
```

---

#### ③ 麻布しき

```
週報を作成してください。

## インプット情報
- 運営会社: 麻布しき
- 対象週: 2026-W06
- 対象週の終了日: 2026-02-08

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_週報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_曜日深堀分析_プロンプト.md` に従って曜日深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成

## 最終成果物
- `./2_output/麻布しき/2_output_2026w06/週報スライド構成案.md`
```

---

#### ④ キーポイント（かめや駅前店）

```
週報を作成してください。

## インプット情報
- 運営会社: キーポイント
- 対象週: 2026-W06
- 対象週の終了日: 2026-02-08

## 実行手順
以下のプロンプトを順番に実行し、最終的にスライド構成案を作成してください。

1. `./01_週報作成プロンプトテンプレート.md` に従って基礎資料を作成
2. `./02_曜日深堀分析_プロンプト.md` に従って曜日深掘り分析を実行
3. `./03_スライド構成案作成_プロンプト.md` に従ってスライド構成案を作成

## 最終成果物
- `./2_output/キーポイント/2_output_2026w06/週報スライド構成案.md`
```

---

---

## 重要ルール（運用ガバナンス）
- 01/02/03は **AI実行手順のみ**（入力・手順・出力・チェック）を残す  
  - 更新履歴・背景説明・人向けの長文説明は **本ファイル（00）** に寄せる
- 変数名は 01/02/03で共通化する（下記の“変数”参照）
- 出力先は `2_output/{運営会社}/2_output_{week_slug}/` を標準とする  
  - `week_slug` は `2026-W04` → `2026w04`（小文字化 + `-`除去）

## 変数（01/02/03で共通利用）
- `{運営会社コード}`: `BFA` / `BBC` / `麻布しき` / `キーポイント`
- `{対象週}`: `YYYY-Www`（ISO週）
- `{終了日}`: `YYYY-MM-DD`
- `{week_slug}`: `YYYYwWW`（例: `2026w04`）
- `{出力ディレクトリ}`: `./2_output/{運営会社コード}/2_output_{week_slug}`
- `{入力売上}`: `./1_input/{運営会社コード}/rawdata.csv`
- `{入力口コミ}`: `./1_input/{運営会社コード}/reviews.csv`
- `{週報基礎資料}`: `{出力ディレクトリ}/週報作成基礎資料.md`
- `{スライド構成}`: `{出力ディレクトリ}/週報スライド構成案.md`

### AIが自動算出するもの（ユーザー入力不要）
- `{week_slug}`（例: `2026-W04` → `2026w04`）
- `{出力ディレクトリ}`（上記ルールで組み立て）
- `{入力売上}` / `{入力口コミ}`（上記ルールで組み立て）

---

## AIエージェントの実行フロー（概要）

```
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 0】準備                                                      │
│ - インプット情報を確認                                              │
│ - 入力データ（rawdata.csv, reviews.csv）の存在確認                  │
│ - {出力ディレクトリ} の作成                                         │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 1】フェーズ1: 基礎資料作成                                   │
│ プロンプト: 01_週報作成プロンプトテンプレート.md                    │
│                                                                     │
│ 実行内容:                                                           │
│ 1. analysis_script.py を実行してデータ分析                          │
│ 2. 生成されたデータ・グラフを確認                                   │
│ 3. 週報作成基礎資料.md を作成                                       │
│                                                                     │
│ 出力確認:                                                           │
│ - analysis_results.json が生成されていること                        │
│ - weekday_decomposition.csv が生成されていること                    │
│ - 各種グラフ（PNG）が生成されていること                             │
│ - 週報作成基礎資料.md が作成されていること                          │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 2】フェーズ2: 曜日深掘り分析                                 │
│ プロンプト: 02_曜日深堀分析_プロンプト.md                           │
│                                                                     │
│ 実行内容:                                                           │
│ 1. weekday_decomposition.csv から好調/不調曜日を特定                │
│ 2. deep_dive_weekday_analysis.py を実行（または手動分析）           │
│ 3. 5つの観点で両曜日を比較分析                                      │
│ 4. 週報作成基礎資料.md に深掘り分析を追記                           │
│                                                                     │
│ 出力確認:                                                           │
│ - 好調曜日と不調曜日が特定されていること                            │
│ - パーティサイズ、時間帯、会計レベル、商品ミックスの分析結果        │
│ - 週報作成基礎資料.md に追記されていること                          │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 3】フェーズ3: スライド構成案作成                             │
│ プロンプト: 03_スライド構成案作成_プロンプト.md                     │
│                                                                     │
│ 実行内容:                                                           │
│ 1. スライドテンプレートを参照                                       │
│ 2. 週報作成基礎資料.md をもとにスライド構成案を作成                 │
│ 3. 各スライドにグラフ描画用のデータ表を記載                         │
│                                                                     │
│ 出力確認:                                                           │
│ - 28枚構成のスライド構成案が作成されていること                      │
│ - 各スライドにグラフ用データ表が含まれていること                    │
│ - 週報スライド構成案.md が保存されていること                        │
└─────────────────────────────────────────────────────────────────────┘
                                  ↓
┌─────────────────────────────────────────────────────────────────────┐
│ 【Step 4】完了報告                                                  │
│ - 作成されたファイル一覧を報告                                      │
│ - 主要なインサイト（売上、好調/不調曜日など）をサマリー報告         │
└─────────────────────────────────────────────────────────────────────┘
```

---

---

## 参照ファイル一覧

### プロンプトファイル
| 順番 | ファイル | 用途 |
|:---:|----------|------|
| 01 | `01_週報作成プロンプトテンプレート.md` | 基礎資料作成 |
| 02 | `02_曜日深堀分析_プロンプト.md` | 曜日深掘り分析 |
| 03 | `03_スライド構成案作成_プロンプト.md` | スライド構成案作成 |

### スクリプト
| ファイル | 用途 |
|----------|------|
| `./Scripts/analysis_script.py` | フェーズ1: データ分析・グラフ生成 |
| `./Scripts/deep_dive_weekday_analysis.py` | フェーズ2: 曜日深掘り分析 |

### テンプレート・参照資料
| ファイル | 用途 |
|----------|------|
| `./分析観点.md` | AI分析時の判断基準 |
| `./3.template/週報スライド構成テンプレート.md` | スライド構成の雛形 |

### 入力データ
| ファイル | 用途 |
|----------|------|
| `./1_input/{運営会社コード}/rawdata.csv` | 売上トランザクションデータ |
| `./1_input/{運営会社コード}/reviews.csv` | 口コミデータ |

---

---

## 最終成果物（完了条件）

以下のファイルが作成されていれば完了です：

```
Stock/RestaurantAILab/週報/2_output/{運営会社}/2_output_{week}/
│
├── 【スライド用データ（テキスト形式）】※ 常に出力
│   ├── slide_data_part1.txt    # 第1部用（週次トレンド、KPI）
│   ├── slide_data_part2.txt    # 第2部用（曜日別概況、深掘りデータ）
│   └── slide_data_part3.txt    # 第3部用（カテゴリ、商品TOP10）
│
├── 【データファイル（CSV/JSON）】※ 常に出力
│   ├── analysis_results.json
│   ├── weekday_decomposition.csv
│   ├── weekly_sales.csv
│   ├── hourly_sales.csv
│   ├── category_latest.csv
│   └── product_latest.csv
│
├── 【グラフ画像（PNG）】※ --images 指定時のみ
│   ├── weekly_sales_comparison.png
│   ├── weekly_sales_trend.png
│   ├── weekday_decomposition.png
│   ├── hourly_sales.png
│   ├── category_sales.png
│   └── top_products.png
│
├── 【週報基礎資料】
│   └── 週報作成基礎資料.md
│
└── 【フェーズ3の成果物】
    └── 週報スライド構成案.md    ← 最終成果物
```

---

---

## エラー時の対応（最小）

### フェーズ1でエラーが発生した場合
- rawdata.csv または reviews.csv が存在するか確認
- 対象週のデータが含まれているか確認
- Pythonスクリプトのパスが正しいか確認

### フェーズ2でエラーが発生した場合
- weekday_decomposition.csv が生成されているか確認
- 好調/不調曜日の日付が対象週内に存在するか確認

### フェーズ3でエラーが発生した場合
- 週報作成基礎資料.md が作成されているか確認
- スライドテンプレートのパスが正しいか確認

---

---

## 注意事項（設計意図）

1. **データの事前準備**
   - rawdata.csv と reviews.csv が最新のデータで更新されていることを確認
   - 対象週のデータが含まれていることを確認

2. **週番号の計算**
   - ISO 8601週番号を使用（月曜日始まり）
   - 年をまたぐ週は翌年の週番号（例: 2025-12-29〜2026-01-03 = 2026-W01）

3. **営業日基準**
   - 深夜0-5時は前日の営業日としてカウント
   - 時間別分析は18-26時（深夜は24時以降表記）

4. **グラフデータの完全性**
   - スライド構成案には、グラフ描画に必要な全データを表形式で記載
   - 省略せず、全データポイントを含める

---

## プロンプト資産の更新履歴（00に集約）
> 01/02/03から“更新履歴”や“更新内容”の記述を移管します。

- 2026-01-28: 01/02/03を「AIが参照して実行できる手順書」へ整理し、更新履歴/設計意図を00に集約
- 2026-01-27: 初版作成

### 01（基礎資料作成）に関する更新メモ（移管）
- v3.1: 目的（ビジネス目的・技術目的）を明記
- v3.0: 複数店舗対応（運営会社ごとに入出力フォルダ分離）
- v2.4: 曜日別要因分解の比較対象を「前週」→「過去4週間の移動平均」に変更
- v2.3: グラフ簡素化（カテゴリ/商品は円グラフ中心、比較表現の整理）
- v2.2: Markdownへの画像挿入指示追加、直近5週表示、売上比較棒グラフ追加
- v2.1: 曜日別要因分解追加、UTC→JST/営業日定義明記、営業時間18-26時に統一

### 02（曜日深掘り）に関する更新メモ（移管）
- 2026-01-05: 初版作成（2026-W01分析を基に）

### 03（スライド構成案）に関する更新メモ（移管）
- 2026-01-27: 初版作成
