## 目的 / 背景
Instagram向けショート動画の台本を、人のテーマ入力からAIで「骨子生成 → 台本生成」まで半自動化する。契約上の前提（Stock/リライフメディカル/Phase１/1_initiating/業務委託契約書.md）に基づき、納品はドキュメント/テンプレート/生成物で行い、実装ツールのノウハウは成果物に組み込まない限り乙に帰属する点を考慮する。

参照サンプル：
- 骨子の例: `Stock/リライフメディカル/Phase１/2.PoC/お役立ち情報骨子,md`
- 台本の例: `Stock/リライフメディカル/Phase１/2.PoC/お役立ち情報台本_rewritten2.csv`

---

## スコープ
- テーマ入力UI（人がキーワード/話題を入力）
- 骨子生成（AIが3案を提示）と、人手での微修正・複数選択
- 選択された骨子から台本生成（AI）
- 生成結果のエクスポート（CSV／Markdown）
- ログ保存（入力/出力/プロンプト／モデル応答の監査用）

アウトオブスコープ（初期版）
- 自動TTS化・動画レンダリング（PoC資産は将来連携オプション）
- SNS自動投稿

---

## 想定ユーザー / 利用シナリオ
- クリニック運用担当者、制作担当者がテーマを入力し、最短で台本CSVを得る。
- 骨子の3案から1つ以上を選び、必要に応じて編集してから台本化。

---

## データ仕様
### 骨子（Outline）スキーマ（美容お役立ち：既存）
骨子は下記の列を基本とする（サンプル準拠・必要に応じて列の省略/追加可）。
- No.
- カテゴリ・テーマ
- 素朴な疑問
- 人体に関する前提知識
- 人体以外に関する前提知識
- 提供できる回答（要約）
- 出典（URL/媒体名）

格納形式：Markdownテーブル（推奨）、もしくはJSON。UIでは各列を編集可能にする。

### 台本（Script）スキーマ（CSV）［美容お役立ち：既存］
ヘッダはサンプルに準拠（既存フォーマット）：
- No.
- テーマ
- フック
- 共感
- 前提知識
- メイン解説
- 解説まとめ
- 実践
- CTA

### 骨子（Outline）スキーマ［施術紹介］
- No.
- 施術名/テーマ
- 対象悩み（例：乾燥・くすみ・たるみ など）
- 施術概要（瀬術名、期待される効果）
- 注意（禁忌/注意事項）

### 台本（Script）スキーマ（CSV）［施術紹介］
- No.
- テーマ（施術名）
- フック（冒頭3秒）
- 悩みの提示
- 施術紹介（本命パート）
- 効果・Before/After
- まとめ
- CTA
- ビジュアル指示（任意）

長さガイド（目安）：フック〜CTAで45秒程度。効果・Before/Afterは短い比較表現を推奨。

### 骨子（Outline）スキーマ［質問回答］
- No.
- 質問文（視聴者の疑問）
- 回答要旨（結論）
- 解説要点（メカニズム）
- 解決策の方向性（院の施術/セルフケア）
- エビデンス/出典

### 台本（Script）スキーマ（CSV）［質問回答］
- No.
- テーマ（質問トピック）
- フック兼質問紹介（冒頭3秒）
- 共感
- 回答の提示（簡潔な回答を最初に示す）
- 解説（前提知識）
- 解説（質問への回答）
- 行動提案（セルフケアの方法の提案または院でできる対応の紹介）
- CTA

長さガイド（目安）：フック〜CTAで45秒程度。回答→解説→解決策の論理接続を明確に。

---

## ユースフロー / 画面要件
1) テーマ入力
- テーマ入力欄を5つ用意（Theme1〜Theme5）。空欄はスキップ可能。
- 各欄に1テーマずつ入力（例："マスク 肌荒れ", "化粧水 乳液 タイミング" など）
- 各テーマ欄でフォーマットを選択：［美容お役立ち｜施術紹介｜質問回答］（未選択時は「美容お役立ち」を既定）
- 生成オプション：トーン（専門/やさしい）、対象（10代/20-30代/30-40代等）

2) 骨子生成（AI）
- 入力された各テーマごとに骨子を3案生成（最大 5 テーマ × 3 案 = 15 骨子）
- それぞれUI上でプレビュー・編集（列ごとにテキスト編集）
- テーマ横断で1つ以上を選択して次へ進む（複数選択可）

3) 台本生成（AI）
- 選択された骨子ごとに、CSV行を生成
- セクション別の長さ目安をプロンプトで制御
- 生成結果をテーブル表示

4) エクスポート / 保存
- CSVダウンロード（UTF-8, ヘッダ付）。フォーマットのヘッダ構成が異なるため、まとめる場合はフォーマット別CSVで出力（例：beauty_tips.csv／treatment_intro.csv／qa.csv）。
- プロジェクト内保存先の既定：`Stock/リライフメディカル/Phase１/2.PoC/` 配下（または作業日の `Flow/YYYYMM/YYYY-MM-DD/`）

---

## AI要件
- モデル：Gemini
- 骨子生成：3案生成（温度高め 0.7-1.0 ）
- 台本生成：一貫性重視（温度0.4-0.7）
- プロンプト：
  - 骨子生成時：上記骨子スキーマ準拠、出典の明記（可能な限り）
  - 台本生成時：CSVヘッダ固定、各秒数レンジを満たすテキスト量ガイド、医療表現の注意（誇大/断定回避）
  - 複数テーマ入力時はテーマごとの独立性を担保（前テーマの文脈リーク防止）
  - フォーマット別プロンプトを用意（美容お役立ち／施術紹介／質問回答）
- ガードレール：医療助言に関する免責文の挿入オプション、確度低い主張には出典必須
- ログ：入力、最終プロンプト、モデル名、出力、生成時間、トークン量

---

## 非機能要件
- 言語：日本語
- 再現性：同テーマでもバリエーション確保（シード/温度調整）
- 監査：生成ログと出典の保持
- セキュリティ：個人情報を扱わない前提。機密情報は入力しない警告表示
- パフォーマンス：骨子3案 < 10秒/テーマ、台本1本 < 10秒（モデル/API次第）
  - 同時5テーマ（最大15骨子/15台本）時は並列実行を採用し、全体 < 30秒を目標
  - APIレート制限に応じてバッチ/キュー制御を実装

---

## 既存資産との連携（任意）
- PoCのTTSスクリプト（`2.PoC/scripts/tts-from-csv.py`）にCSVを渡すことで音声分割生成が可能
- 将来的に「台本CSV → 自動TTS → 動画化」へ拡張予定

---

## 受け入れ条件（例）
- テーマ5欄で入力→各テーマにつき骨子3案（最大15）→編集/複数選択→台本CSV出力（最大15本）が一連で完了する
- 出力CSVが選択フォーマットの定義済みヘッダ（上記スキーマ）と完全一致である
- セクション文量がおおむね秒数ガイドに収まる
- 出典カラムが空の場合、UIで警告（保存は可）

---

## 設計メモ（実装の目安）
- 技術スタック（要選定）：
  - Web（React/Next.js）+ API（Python FastAPI / Node）
  - もしくはローカルElectron/簡易CLI（初期スコープ短縮）
- ストレージ：ローカル保存（指定パス）、履歴はJSON（プロジェクトごと）
- 長さ制約：文字数上限をセクションごとに設定（例：フック80-120字 等）
 - ID設計：themeId（1..5）、outlineId（themeIdに紐づく連番1..3）、scriptId（UUID）でトレース可能にする
 - フォーマット管理：format（beauty_tips｜treatment_intro｜qa）でテンプレート切替、CSVヘッダとプロンプトをバインド

---

## 未確定事項 / 確認したい点（ご回答ください）
1) プラットフォーム希望：Webアプリ / ローカルアプリ / CLI のどれが良いですか？
2) 利用モデル：OpenAI / Google / 既存アカウントのAPI指定はありますか？
3) 文章トーン：専門寄り / やさしい / クリニックらしさ（口調ガイド）をどうしますか？
4) CTAの定型：予約誘導/保存・コメント促進/サイト遷移などの優先順位は？
5) 保存先の既定：`Stock/…/2.PoC` と `Flow/…` のどちらを標準にしますか？
6) 出典の扱い：必須/任意、URL可否、院内資料の参照可否
7) セクションの文字数ガイド：秒数から算出する標準文字数レンジを確定しますか？
8) 将来拡張：TTS自動化や動画化までのロードマップ希望はありますか？

---

## 納品物（本タスク）
- 本要件定義（本ファイル）
- 骨子/台本サンプルに準拠した出力仕様定義
- 初期プロンプト雛形（骨子生成用／台本生成用）

（ご回答を反映して、画面モック・API仕様・プロンプト詳細へ具体化します）


